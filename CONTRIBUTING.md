# Gu√≠a de Contribuci√≥n - ORION

¬°Gracias por tu inter√©s en contribuir a ORION! üéâ

## üìã Tabla de Contenidos

- [C√≥digo de Conducta](#c√≥digo-de-conducta)
- [¬øC√≥mo puedo contribuir?](#c√≥mo-puedo-contribuir)
- [Configuraci√≥n del Entorno](#configuraci√≥n-del-entorno)
- [Proceso de Pull Request](#proceso-de-pull-request)
- [Gu√≠a de Estilo](#gu√≠a-de-estilo)
- [Reportar Bugs](#reportar-bugs)
- [Sugerir Features](#sugerir-features)

---

## C√≥digo de Conducta

Este proyecto adhiere a un C√≥digo de Conducta. Al participar, se espera que mantengas este c√≥digo. Por favor reporta comportamientos inaceptables a soporte@orion.com.

### Nuestros Est√°ndares

- ‚úÖ Usar lenguaje acogedor e inclusivo
- ‚úÖ Respetar diferentes puntos de vista y experiencias
- ‚úÖ Aceptar cr√≠ticas constructivas con gracia
- ‚úÖ Enfocarse en lo que es mejor para la comunidad
- ‚ùå Uso de lenguaje o im√°genes sexualizadas
- ‚ùå Trolling, comentarios insultantes o ataques personales
- ‚ùå Acoso p√∫blico o privado

---

## ¬øC√≥mo puedo contribuir?

### üêõ Reportar Bugs

Si encuentras un bug, por favor:

1. **Busca** primero en los [issues existentes](https://github.com/tu-usuario/orion/issues)
2. Si no existe, **crea un nuevo issue** con:
   - T√≠tulo descriptivo
   - Pasos para reproducir el problema
   - Comportamiento esperado vs actual
   - Logs relevantes
   - Versi√≥n de Python, Docker, etc.

**Ejemplo:**

```markdown
**Descripci√≥n:** El NLU no clasifica correctamente mensajes con emojis

**Pasos para reproducir:**
1. Enviar mensaje: "Hola üòä donde esta mi pedido 12345?"
2. Ver respuesta

**Esperado:** Intent = trackear_pedido
**Actual:** Intent = intencion_desconocida

**Logs:**
[Incluir logs relevantes]

**Entorno:**
- Python: 3.11
- Docker: 20.10.21
- OS: Ubuntu 22.04
```

### ‚ú® Sugerir Features

Para sugerir nuevas caracter√≠sticas:

1. **Abre un issue** con el tag `enhancement`
2. Describe:
   - El problema que resuelve
   - C√≥mo lo imaginas funcionando
   - Beneficios para los usuarios
   - Posible implementaci√≥n

### üíª Contribuir C√≥digo

1. **Fork** el repositorio
2. **Clona** tu fork: `git clone https://github.com/tu-usuario/orion.git`
3. **Crea una rama**: `git checkout -b feature/mi-feature`
4. **Haz tus cambios**
5. **Agrega tests**
6. **Commit**: `git commit -m 'feat: agregar nueva funcionalidad'`
7. **Push**: `git push origin feature/mi-feature`
8. **Abre un Pull Request**

---

## Configuraci√≥n del Entorno

### 1. Prerrequisitos

- Python 3.11+
- Docker 20.10+
- Git

### 2. Clonar y Configurar

```bash
# Clonar repositorio
git clone https://github.com/tu-usuario/orion.git
cd orion

# Crear entorno virtual
python -m venv venv
source venv/bin/activate  # En Windows: venv\Scripts\activate

# Instalar dependencias de desarrollo
pip install -r requirements-dev.txt

# Configurar pre-commit hooks
pre-commit install
```

### 3. Levantar Servicios

```bash
docker-compose up --build
```

### 4. Ejecutar Tests

```bash
# Tests unitarios
pytest tests/ -v

# Tests de integraci√≥n
python test_nlu_enhanced.py

# Stress tests
python stress_test.py

# Coverage
pytest tests/ --cov=app --cov-report=html
```

---

## Proceso de Pull Request

### Antes de Enviar

- [ ] Los tests pasan (`pytest tests/`)
- [ ] El c√≥digo sigue la gu√≠a de estilo (PEP 8)
- [ ] Agregaste tests para nuevas funcionalidades
- [ ] Actualizaste la documentaci√≥n si es necesario
- [ ] Los commits siguen [Conventional Commits](#convenci√≥n-de-commits)

### Conventional Commits

Usamos [Conventional Commits](https://www.conventionalcommits.org/) para mensajes:

```
<tipo>(<scope>): <descripci√≥n>

[cuerpo opcional]

[footer opcional]
```

**Tipos:**
- `feat`: Nueva funcionalidad
- `fix`: Correcci√≥n de bug
- `docs`: Cambios en documentaci√≥n
- `style`: Formateo, punto y coma faltantes, etc.
- `refactor`: Refactorizaci√≥n de c√≥digo
- `test`: Agregar o modificar tests
- `chore`: Mantenimiento, dependencias, etc.

**Ejemplos:**

```bash
git commit -m "feat(nlu): agregar soporte para emojis"
git commit -m "fix(api): corregir timeout en webhook"
git commit -m "docs(readme): actualizar instrucciones de instalaci√≥n"
git commit -m "test(nlu): agregar tests para normalizaci√≥n"
```

### Revisi√≥n de C√≥digo

Tu PR ser√° revisado por al menos un mantenedor. Pueden solicitar cambios. Por favor:

- Responde a los comentarios
- Haz los cambios solicitados
- Marca conversaciones como resueltas

---

## Gu√≠a de Estilo

### Python

Seguimos **PEP 8** con algunas excepciones:

- Longitud m√°xima de l√≠nea: **100 caracteres**
- Usar **type hints** siempre que sea posible
- Docstrings en **Google Style**

**Ejemplo:**

```python
from typing import Dict, List

def procesar_mensaje(texto: str, user_id: str) -> Dict[str, any]:
    """
    Procesa un mensaje de usuario y retorna la respuesta.
    
    Args:
        texto: El mensaje del usuario
        user_id: ID √∫nico del usuario
        
    Returns:
        Dict con la respuesta y metadatos
        
    Raises:
        ValueError: Si el texto est√° vac√≠o
        
    Examples:
        >>> procesar_mensaje("Hola", "user123")
        {"response": "Hola!", "intent": "saludo"}
    """
    if not texto:
        raise ValueError("El texto no puede estar vac√≠o")
    
    # Tu c√≥digo aqu√≠
    return {"response": "...", "intent": "..."}
```

### Formato Autom√°tico

Usamos herramientas de auto-formato:

```bash
# Black para formateo
black .

# isort para ordenar imports
isort .

# flake8 para linting
flake8 .

# mypy para type checking
mypy app/
```

### Estructura de Archivos

```python
# 1. Imports est√°ndar
import os
import sys
from datetime import datetime

# 2. Imports de terceros
import httpx
from fastapi import FastAPI
from pydantic import BaseModel

# 3. Imports locales
from app.utils import normalize_text
from app.models import UserMessage

# 4. Constantes
API_VERSION = "1.0.0"
MAX_RETRIES = 3

# 5. C√≥digo
class MyClass:
    pass

def my_function():
    pass
```

### Nombres

- **Variables**: `snake_case`
- **Funciones**: `snake_case`
- **Clases**: `PascalCase`
- **Constantes**: `UPPER_SNAKE_CASE`
- **Privados**: `_prefijo_con_guion_bajo`

---

## Testing

### Escribir Tests

```python
import pytest
from app.main import procesar_mensaje

class TestProcesarMensaje:
    """Tests para la funci√≥n procesar_mensaje."""
    
    def test_mensaje_simple(self):
        """Debe procesar un mensaje simple correctamente."""
        resultado = procesar_mensaje("Hola", "user123")
        
        assert resultado["intent"] == "saludo"
        assert resultado["confidence"] > 0.8
    
    def test_mensaje_vacio(self):
        """Debe lanzar error con mensaje vac√≠o."""
        with pytest.raises(ValueError):
            procesar_mensaje("", "user123")
    
    @pytest.mark.parametrize("texto,intent_esperado", [
        ("donde esta mi pedido", "trackear_pedido"),
        ("tienen stock", "consultar_stock"),
        ("cuanto cuesta", "consultar_precio"),
    ])
    def test_multiples_intents(self, texto, intent_esperado):
        """Debe clasificar correctamente m√∫ltiples intents."""
        resultado = procesar_mensaje(texto, "user123")
        assert resultado["intent"] == intent_esperado
```

### Cobertura de Tests

Mantenemos **>80%** de cobertura:

```bash
pytest tests/ --cov=app --cov-report=term-missing
```

---

## Documentaci√≥n

### Actualizar Documentaci√≥n

Si tu cambio afecta:

- **README.md**: Actualiza instrucciones de uso
- **API docs**: Actualiza ejemplos de endpoints
- **C√≥digo**: Agrega/actualiza docstrings

### Escribir Docstrings

Usamos **Google Style**:

```python
def mi_funcion(param1: str, param2: int) -> bool:
    """
    Resumen de una l√≠nea de lo que hace la funci√≥n.
    
    Descripci√≥n m√°s detallada si es necesario.
    Puede ser de m√∫ltiples l√≠neas.
    
    Args:
        param1: Descripci√≥n del primer par√°metro
        param2: Descripci√≥n del segundo par√°metro
        
    Returns:
        Descripci√≥n de lo que retorna
        
    Raises:
        ValueError: Cuando param2 es negativo
        TypeError: Cuando param1 no es string
        
    Examples:
        >>> mi_funcion("test", 5)
        True
    """
    pass
```

---

## Herramientas √ötiles

### Pre-commit Hooks

Instala hooks para validar antes de commit:

```bash
pip install pre-commit
pre-commit install
```

Crea `.pre-commit-config.yaml`:

```yaml
repos:
  - repo: https://github.com/psf/black
    rev: 23.1.0
    hooks:
      - id: black
  
  - repo: https://github.com/pycqa/isort
    rev: 5.12.0
    hooks:
      - id: isort
  
  - repo: https://github.com/pycqa/flake8
    rev: 6.0.0
    hooks:
      - id: flake8
```

### VS Code Settings

`.vscode/settings.json`:

```json
{
  "python.formatting.provider": "black",
  "python.linting.enabled": true,
  "python.linting.flake8Enabled": true,
  "editor.formatOnSave": true,
  "editor.codeActionsOnSave": {
    "source.organizeImports": true
  }
}
```

---

## Preguntas Frecuentes

### ¬øC√≥mo ejecuto un solo test?

```bash
pytest tests/test_nlu.py::test_clasificacion_simple -v
```

### ¬øC√≥mo debugging en Docker?

Agrega `pdb` en tu c√≥digo:

```python
import pdb; pdb.set_trace()
```

Luego ejecuta con:

```bash
docker-compose run --service-ports nlu python -m pdb app/main.py
```

### ¬øC√≥mo actualizo dependencias?

```bash
# Ver outdated
pip list --outdated

# Actualizar
pip install --upgrade package-name

# Actualizar requirements
pip freeze > requirements.txt
```

---

## Reconocimientos

Todos los contribuidores son listados en el [Contributors](https://github.com/tu-usuario/orion/graphs/contributors).

**Top Contributors:**

- [@usuario1](https://github.com/usuario1) - 150 commits
- [@usuario2](https://github.com/usuario2) - 89 commits
- [@usuario3](https://github.com/usuario3) - 67 commits

---

## Contacto

¬øPreguntas? Contacta a:

- **Email**: dev@orion.com
- **Discord**: https://discord.gg/orion
- **Twitter**: [@OrionProject](https://twitter.com/OrionProject)

---

¬°Gracias por contribuir a ORION! üöÄ
